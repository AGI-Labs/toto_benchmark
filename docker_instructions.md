# Docker Instructions

## Requirements
1. Install [nvidia-docker v2](https://github.com/NVIDIA/nvidia-docker) following instructions here: [https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/install-guide.html#docker](https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/install-guide.html#docker).
Note: only supports Linux; no Windows or MacOS.
2. Cuda version >= 11.4 should be installed on the host.

## Build Docker Image

```
docker build . -t TOTO_starter:deploy
```

## Run Docker Container interactively (with the dataset mounted)
- DATASETS_PATH: the path on the host machine which contains the robocloud dataset
```
docker run -v $DATASETS_PATH:$DATASETS_PATH -it --runtime=nvidia --shm-size 8G --gpus all TOTO_starter:deploy
```
example usage:
```
docker run -v /RoboCloud:/RoboCloud -it --runtime=nvidia --shm-size 8G --gpus all TOTO_starter:deploy
```

## Train the agent (from docker container interactive shell)
```
cd TOTO_starter
python train_example.py --config-name train_bcimage.yaml
```

## Test the agent locally in a dummy environment (from docker container interactive shell)
- AGENT_PATH: should contain a hydra.yaml file either generated by the training script or manually added. Please refer to conf/train_bcimage.yaml for reference.
```
python test_stub_env.py -f AGENT_PATH
```
example usage
```
cd TOTO_starter
python test_stub_env.py -f ./outputs/dummy_agent
```
